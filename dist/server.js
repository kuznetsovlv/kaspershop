!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("http"),require("url"),require("path"),require("fs"),require("domain")):"function"==typeof define&&define.amd?define(["http","url","path","fs","domain"],e):"object"==typeof exports?exports.kasperskyShop=e(require("http"),require("url"),require("path"),require("fs"),require("domain")):t.kasperskyShop=e(t.http,t.url,t.path,t.fs,t.domain)}(this,function(t,e,n,r,o){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=n(1),i=r(o),u=n(3),a=r(u),s=n(4),c=r(s),f=n(26),l=r(f),d=new i.default(8084,__dirname);d.on("start",a.default),d.on("get",c.default),d.on("post",l.default),d.up()},function(t,e,n){!function(e,r){t.exports=r(n(2))}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.getStatusText=e.getContentType=void 0;var o=n(1),i=r(o),u=n(4),a=r(u),s=n(7),c=r(s);e.default=i.default,e.getContentType=a.default,e.getStatusText=c.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(2),i=r(o);e.default=i.default},function(t,e,n){(function(t){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function u(t,e){var n=t.method,r=n.toLowerCase();Object.prototype.hasOwnProperty.call(f,r)&&f[r](t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var u=o.get;return void 0!==u?u.call(r):void 0},c=n(3),f={},l=function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:80,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;r(this,n);var a=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return a.port=parseFloat(e),a.root=i,a.on=a.on.bind(a),a.up=a.up.bind(a),a.on("request",u.bind(a)),a}return i(n,e),a(n,[{key:"on",value:function(t,e){switch(t){case"start":this.onStart=e.bind(this);break;case"connection":case"request":s(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"on",this).call(this,t,e);break;default:f[t]=e}return this}},{key:"up",value:function(){return s(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"listen",this).call(this,this.port),this.emit("fired"),"function"==typeof this.onStart&&this.onStart(),this}}]),n}(c.Server);e.default=l}).call(e,"/")},function(t,e){t.exports=n(2)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(5),i=r(o);e.default=i.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(6),o={".txt":"text/plain; "+r.charsetCode,".htm":"text/html; "+r.charsetCode,".html":"text/html; "+r.charsetCode,".js":"text/javascript; "+r.charsetCode,".css":"text/css; "+r.charsetCode,".bin":"application/binary",".json":"application/json; "+r.charsetCode,".jpeg":"image/jpeg",".jpg":"image/jpeg",".png":"image/png",".ico":"image/x-icon",".mp4":"video/mp4",".mp3":"audio/mp3",".gif":"image/gif"};e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".html";return/^\..*/.test(t)||(t="."+t),o[t]}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.charsetCode="charset=utf-8"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),i=r(o);e.default=i.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=r(o);e.default=function(t){return i.default[t]}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required",520:"Unknown Error",522:"Origin Connection Time-out",598:"Network read timeout error",599:"Network connect timeout error"}}])})},function(t,e){t.exports=require("http")},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=[500,1e3,1e3,1e3,2e3,3e3,0],r=0;e.default=function(){var t=new Date;console.log("Hello!"),setTimeout(function(){console.log("I'm simple nonamed webserver."),setTimeout(function(){console.log("I'm not very smart and the only protocol which I can is HTTP. =("),setTimeout(function(){console.log("But I belong for this task."),setTimeout(function(){console.log("And of course I'll do my best for you."),setTimeout(function(){console.log("But if you need something else you are able to improve me as you wish."),setTimeout(function(){console.log("Oh! In despite of my monologue and slopping over I have got started. And I'm waiting for your responses about "+((new Date).getTime()-t.getTime())/1e3+" seconds."),setTimeout(function(){return console.log("Let's work!")},n[r++])},n[r++])},n[r++])},n[r++])},n[r++])},n[r++])},n[r++])}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(6),i=n(7),u=n(10);e.default=function(t,e){var n=t.server||{},a=t.url,s=n.root,c=void 0===s?__dirname:s,f=(0,r.parse)(a,!0),l=f.pathname;(0,i.getFileInfo)((0,o.join)(c,l)).then(function(t){var n=t.exists,r=t.fileType,a=t.path,s=t.name;if(n)switch(r){case"regular file":return t;case"directory":return(0,i.getFileInfo)((0,o.join)(a,"index.html")).then(function(t){var n=t.exists,r=t.fileType;return n&&"regular file"===r?t:void(0,u.sendError)(e,404)});default:(0,u.sendError)(e,403)}else(0,u.sendError)(e,404,s+" not found.")}).then(function(t){return(0,u.sendFile)(e,t)},function(t){return(0,u.sendError)(e,500,t.message||t)})}},function(t,e){t.exports=require("url")},function(t,e){t.exports=require("path")},function(t,e,n){!function(e,r){t.exports=r(n(8),n(9),n(6))}(this,function(t,e,r){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.getFileInfo=e.writeFile=e.readFile=void 0;var o=n(1),i=r(o),u=n(15),a=r(u),s=n(17),c=r(s);e.readFile=i.default,e.writeFile=a.default,e.getFileInfo=c.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(2),i=r(o);e.default=i.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),i=n(4),u=r(i);e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1];return new u.default(function(n,r){var i=function(t,e){t?r(t):n(e)};"string"==typeof e?(0,o.readFile)(t,e,i):(0,o.readFile)(t,i)})}},function(t,e){t.exports=n(8)},function(t,e,n){"use strict";t.exports=n(5)},function(t,e,n){"use strict";t.exports=n(6),n(9),n(10),n(11),n(12),n(14)},function(t,e,n){"use strict";function r(){}function o(t){try{return t.then}catch(t){return g=t,_}}function i(t,e){try{return t(e)}catch(t){return g=t,_}}function u(t,e,n){try{t(e,n)}catch(t){return g=t,_}}function a(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,t!==r&&v(t,this)}function s(t,e,n){return new t.constructor(function(o,i){var u=new a(r);u.then(o,i),c(t,new h(e,n,u))})}function c(t,e){for(;3===t._83;)t=t._18;return a._47&&a._47(t),0===t._83?0===t._75?(t._75=1,void(t._38=e)):1===t._75?(t._75=2,void(t._38=[t._38,e])):void t._38.push(e):void f(t,e)}function f(t,e){y(function(){var n=1===t._83?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._83?l(e.promise,t._18):d(e.promise,t._18));var r=i(n,t._18);r===_?d(e.promise,g):l(e.promise,r)})}function l(t,e){if(e===t)return d(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"==typeof e||"function"==typeof e)){var n=o(e);if(n===_)return d(t,g);if(n===t.then&&e instanceof a)return t._83=3,t._18=e,void p(t);if("function"==typeof n)return void v(n.bind(e),t)}t._83=1,t._18=e,p(t)}function d(t,e){t._83=2,t._18=e,a._71&&a._71(t,e),p(t)}function p(t){if(1===t._75&&(c(t,t._38),t._38=null),2===t._75){for(var e=0;e<t._38.length;e++)c(t,t._38[e]);t._38=null}}function h(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function v(t,e){var n=!1,r=u(t,function(t){n||(n=!0,l(e,t))},function(t){n||(n=!0,d(e,t))});n||r!==_||(n=!0,d(e,g))}var y=n(7),g=null,_={};t.exports=a,a._47=null,a._71=null,a._44=r,a.prototype.then=function(t,e){if(this.constructor!==a)return s(this,t,e);var n=new a(r);return c(this,new h(t,e,n)),n}},function(t,e,n){"use strict";function r(t){s.length||(i(),c=!0),s[s.length]=t}function o(){for(;f<s.length;){var t=f;if(f+=1,s[t].call(),f>l){for(var e=0,n=s.length-f;e<n;e++)s[e]=s[e+f];s.length-=f,f=0}}s.length=0,f=0,c=!1}function i(){var t=process.domain;t&&(u||(u=n(8)),u.active=process.domain=null),c&&a?setImmediate(o):process.nextTick(o),t&&(u.active=process.domain=t)}var u,a="function"==typeof setImmediate;t.exports=r;var s=[],c=!1,f=0,l=1024;r.requestFlush=i},function(t,e){t.exports=n(9)},function(t,e,n){"use strict";var r=n(6);t.exports=r,r.prototype.done=function(t,e){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(t){setTimeout(function(){throw t},0)})}},function(t,e,n){"use strict";var r=n(6);t.exports=r,r.prototype.finally=function(t){return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})})}},function(t,e,n){"use strict";function r(t){var e=new o(o._44);return e._83=1,e._18=t,e}var o=n(6);t.exports=o;var i=r(!0),u=r(!1),a=r(null),s=r(void 0),c=r(0),f=r("");o.resolve=function(t){if(t instanceof o)return t;if(null===t)return a;if(void 0===t)return s;if(t===!0)return i;if(t===!1)return u;if(0===t)return c;if(""===t)return f;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new o(e.bind(t))}catch(t){return new o(function(e,n){n(t)})}return r(t)},o.all=function(t){var e=Array.prototype.slice.call(t);return new o(function(t,n){function r(u,a){if(a&&("object"==typeof a||"function"==typeof a)){if(a instanceof o&&a.then===o.prototype.then){for(;3===a._83;)a=a._18;return 1===a._83?r(u,a._18):(2===a._83&&n(a._18),void a.then(function(t){r(u,t)},n))}var s=a.then;if("function"==typeof s){var c=new o(s.bind(a));return void c.then(function(t){r(u,t)},n)}}e[u]=a,0===--i&&t(e)}if(0===e.length)return t([]);for(var i=e.length,u=0;u<e.length;u++)r(u,e[u])})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){t.forEach(function(t){o.resolve(t).then(e,n)})})},o.prototype.catch=function(t){return this.then(null,t)}},function(t,e,n){"use strict";function r(t,e){for(var n=[],r=0;r<e;r++)n.push("a"+r);var o="return function ("+n.join(",")+") {var self = this;return new Promise(function (rs, rj) {var res = fn.call("+["self"].concat(n).concat([a]).join(",")+');if (res &&(typeof res === "object" || typeof res === "function") &&typeof res.then === "function") {rs(res);}});};';return Function(["Promise","fn"],o)(i,t)}function o(t){for(var e=Math.max(t.length-1,3),n=[],r=0;r<e;r++)n.push("a"+r);var o="return function ("+n.join(",")+") {var self = this;var args;var argLength = arguments.length;"+("if (arguments.length > "+e+") {")+"args = new Array(arguments.length + 1);for (var i = 0; i < arguments.length; i++) {args[i] = arguments[i];}}return new Promise(function (rs, rj) {"+("var cb = "+a+";")+"var res;switch (argLength) {"+n.concat(["extra"]).map(function(t,e){return"case "+e+":res = fn.call("+["self"].concat(n.slice(0,e)).concat("cb").join(",")+");break;"}).join("")+'default:args[argLength] = cb;res = fn.apply(self, args);}if (res &&(typeof res === "object" || typeof res === "function") &&typeof res.then === "function") {rs(res);}});};';return Function(["Promise","fn"],o)(i,t)}var i=n(6),u=n(13);t.exports=i,i.denodeify=function(t,e){return"number"==typeof e&&e!==1/0?r(t,e):o(t)};var a="function (err, res) {if (err) { rj(err); } else { rs(res); }}";i.nodeify=function(t){return function(){var e=Array.prototype.slice.call(arguments),n="function"==typeof e[e.length-1]?e.pop():null,r=this;try{return t.apply(this,arguments).nodeify(n,r)}catch(t){if(null===n||void 0===n)return new i(function(e,n){n(t)});u(function(){n.call(r,t)})}}},i.prototype.nodeify=function(t,e){return"function"!=typeof t?this:void this.then(function(n){u(function(){t.call(e,null,n)})},function(n){u(function(){t.call(e,n)})})}},function(t,e,n){"use strict";function r(t){var e;e=u.length?u.pop():new o,e.task=t,e.domain=process.domain,i(e)}function o(){this.task=null,this.domain=null}var i=n(7),u=[];t.exports=r,o.prototype.call=function(){this.domain&&this.domain.enter();var t=!0;try{this.task.call(),t=!1,this.domain&&this.domain.exit()}finally{t&&i.requestFlush(),this.task=null,this.domain=null,u.push(this)}}},function(t,e,n){"use strict";var r=n(6);t.exports=r,r.enableSynchronous=function(){r.prototype.isPending=function(){return 0==this.getState()},r.prototype.isFulfilled=function(){return 1==this.getState()},r.prototype.isRejected=function(){return 2==this.getState()},r.prototype.getValue=function(){if(3===this._83)return this._18.getValue();if(!this.isFulfilled())throw Error("Cannot get a value of an unfulfilled promise.");return this._18},r.prototype.getReason=function(){if(3===this._83)return this._18.getReason();if(!this.isRejected())throw Error("Cannot get a rejection reason of a non-rejected promise.");return this._18},r.prototype.getState=function(){return 3===this._83?this._18.getState():this._83===-1||this._83===-2?0:this._83}},r.disableSynchronous=function(){r.prototype.isPending=void 0,r.prototype.isFulfilled=void 0,r.prototype.isRejected=void 0,r.prototype.getValue=void 0,r.prototype.getReason=void 0,r.prototype.getState=void 0}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(16),i=r(o);e.default=i.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),i=n(4),u=r(i);e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments[1],n=arguments[2];return new u.default(function(r,i){(0,o.writeFile)(t,e,n,function(t){t?i(t):r()})})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(18),i=r(o);e.default=i.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=n(3),u=n(19),a=n(4),s=r(a),c=function(t){return t.isDirectory()?"directory":t.isBlockDevice()?"block device":t.isCharacterDevice()?"character device":t.isSymbolicLink()?"symbol link":t.isFIFO()?"fifo":t.isSocket()?"socket":t.isFile()?"regular file":null};e.default=function(t){return new s.default(function(e,n){var r=(0,u.parse)(t),a=r.ext,s=a.replace(".",""),f=(0,u.normalize)(t),l=f.split(u.sep);(0,i.lstat)(f,function(i,u){if(i){var a=i.code;"ENOENT"===a?e(o({},r,{exists:!1,path:t,normalized:f,normalizedArr:l,mime:s})):n(i)}else{var d=c(u)||"",p=!!d;e(o({},r,u,{path:t,normalized:f,normalizedArr:l,exists:p,fileType:d,mime:s}))}})}).then(function(e){return new s.default(function(n,r){(0,i.realpath)(t,function(t,i){if(t){var a=t.code;"ENOENT"===a?n(o({},e,{exists:!1})):r(t)}else{var s=i.split(u.sep),c=(0,u.relative)(process.cwd(),i);n(o({},e,{relative:c,absolute:i,absoluteArr:s}))}})})})}},function(t,e){t.exports=n(6)}])})},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("domain")},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.compressCathegories=e.expandCathegories=e.getPostData=e.sendData=e.sendFile=e.sendError=void 0;var o=n(11),i=r(o),u=n(12),a=r(u),s=n(13),c=r(s),f=n(14),l=r(f),d=n(25);e.sendError=i.default,e.sendFile=a.default,e.sendData=c.default,e.getPostData=l.default,e.expandCathegories=d.expandCathegories,e.compressCathegories=d.compressCathegories},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.default=function(t,e,n){t.statusCode=e,t.statusMessage=n||(0,r.getStatusText)(e),t.end()}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(7),i=n(1),u=n(11),a=r(u);e.default=function(t,e){var n=e.path,r=e.ext,u=e.exists,s=e.size;u?(0,o.readFile)(n).then(function(e){t.statusCode=200,t.statusMessage="OK",t.setHeader("Content-Type",(0,i.getContentType)(r)),t.setHeader("Content-Length",s),t.write(e,function(){return t.end()})},function(e){return(0,a.default)(t,500,e.message||e)}):(0,a.default)(t,500,"Incorrect server code!")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1);e.default=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=JSON.stringify(e?{success:e,output:n}:{success:e,error:n});t.statusCode=200,t.statusMessage="OK",t.setHeader("Content-Type",(0,r.getContentType)("json")),t.end(o)}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=n(5),u=n(6),a=n(15),s=r(a);e.default=function(t){return new s.default(function(e,n){var r=[];t.on("data",function(t){r.push(""+t)}),t.on("end",function(){try{var a=JSON.parse(r.join("")),s=t.server||{},c=t.url,f=s.root,l=void 0===f?__dirname:f,d=(0,i.parse)(c,!0),p=d.pathname,h=(0,u.join)(l,p);e(o({},a,{path:h}))}catch(t){n(t)}})})}},function(t,e,n){"use strict";t.exports=n(16)},function(t,e,n){"use strict";t.exports=n(17),n(19),n(20),n(21),n(22),n(24)},function(t,e,n){"use strict";function r(){}function o(t){try{return t.then}catch(t){return g=t,_}}function i(t,e){try{return t(e)}catch(t){return g=t,_}}function u(t,e,n){try{t(e,n)}catch(t){return g=t,_}}function a(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,t!==r&&v(t,this)}function s(t,e,n){return new t.constructor(function(o,i){var u=new a(r);u.then(o,i),c(t,new h(e,n,u))})}function c(t,e){for(;3===t._83;)t=t._18;return a._47&&a._47(t),0===t._83?0===t._75?(t._75=1,void(t._38=e)):1===t._75?(t._75=2,void(t._38=[t._38,e])):void t._38.push(e):void f(t,e)}function f(t,e){y(function(){var n=1===t._83?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._83?l(e.promise,t._18):d(e.promise,t._18));var r=i(n,t._18);r===_?d(e.promise,g):l(e.promise,r)})}function l(t,e){if(e===t)return d(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"==typeof e||"function"==typeof e)){var n=o(e);if(n===_)return d(t,g);if(n===t.then&&e instanceof a)return t._83=3,t._18=e,void p(t);if("function"==typeof n)return void v(n.bind(e),t)}t._83=1,t._18=e,p(t)}function d(t,e){t._83=2,t._18=e,a._71&&a._71(t,e),p(t)}function p(t){if(1===t._75&&(c(t,t._38),t._38=null),2===t._75){for(var e=0;e<t._38.length;e++)c(t,t._38[e]);t._38=null}}function h(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function v(t,e){var n=!1,r=u(t,function(t){n||(n=!0,l(e,t))},function(t){n||(n=!0,d(e,t))});n||r!==_||(n=!0,d(e,g))}var y=n(18),g=null,_={};t.exports=a,a._47=null,a._71=null,a._44=r,a.prototype.then=function(t,e){if(this.constructor!==a)return s(this,t,e);var n=new a(r);return c(this,new h(t,e,n)),n}},function(t,e,n){"use strict";function r(t){s.length||(i(),c=!0),s[s.length]=t}function o(){for(;f<s.length;){var t=f;if(f+=1,s[t].call(),f>l){for(var e=0,n=s.length-f;e<n;e++)s[e]=s[e+f];s.length-=f,f=0}}s.length=0,f=0,c=!1}function i(){var t=process.domain;t&&(u||(u=n(9)),u.active=process.domain=null),c&&a?setImmediate(o):process.nextTick(o),t&&(u.active=process.domain=t)}var u,a="function"==typeof setImmediate;t.exports=r;var s=[],c=!1,f=0,l=1024;r.requestFlush=i},function(t,e,n){"use strict";var r=n(17);t.exports=r,r.prototype.done=function(t,e){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(t){setTimeout(function(){throw t},0)})}},function(t,e,n){"use strict";var r=n(17);t.exports=r,r.prototype.finally=function(t){return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})})}},function(t,e,n){"use strict";function r(t){var e=new o(o._44);return e._83=1,e._18=t,e}var o=n(17);t.exports=o;var i=r(!0),u=r(!1),a=r(null),s=r(void 0),c=r(0),f=r("");o.resolve=function(t){if(t instanceof o)return t;if(null===t)return a;if(void 0===t)return s;if(t===!0)return i;if(t===!1)return u;if(0===t)return c;if(""===t)return f;if("object"==typeof t||"function"==typeof t)try{var e=t.then;if("function"==typeof e)return new o(e.bind(t))}catch(t){return new o(function(e,n){n(t)})}return r(t)},o.all=function(t){var e=Array.prototype.slice.call(t);return new o(function(t,n){function r(u,a){if(a&&("object"==typeof a||"function"==typeof a)){if(a instanceof o&&a.then===o.prototype.then){for(;3===a._83;)a=a._18;return 1===a._83?r(u,a._18):(2===a._83&&n(a._18),void a.then(function(t){r(u,t)},n))}var s=a.then;if("function"==typeof s){var c=new o(s.bind(a));return void c.then(function(t){r(u,t)},n)}}e[u]=a,0===--i&&t(e)}if(0===e.length)return t([]);for(var i=e.length,u=0;u<e.length;u++)r(u,e[u])})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){t.forEach(function(t){o.resolve(t).then(e,n)})})},o.prototype.catch=function(t){return this.then(null,t)}},function(t,e,n){"use strict";function r(t,e){for(var n=[],r=0;r<e;r++)n.push("a"+r);var o="return function ("+n.join(",")+") {var self = this;return new Promise(function (rs, rj) {var res = fn.call("+["self"].concat(n).concat([a]).join(",")+');if (res &&(typeof res === "object" || typeof res === "function") &&typeof res.then === "function") {rs(res);}});};';return Function(["Promise","fn"],o)(i,t)}function o(t){for(var e=Math.max(t.length-1,3),n=[],r=0;r<e;r++)n.push("a"+r);var o="return function ("+n.join(",")+") {var self = this;var args;var argLength = arguments.length;"+("if (arguments.length > "+e+") {")+"args = new Array(arguments.length + 1);for (var i = 0; i < arguments.length; i++) {args[i] = arguments[i];}}return new Promise(function (rs, rj) {"+("var cb = "+a+";")+"var res;switch (argLength) {"+n.concat(["extra"]).map(function(t,e){return"case "+e+":res = fn.call("+["self"].concat(n.slice(0,e)).concat("cb").join(",")+");break;"}).join("")+'default:args[argLength] = cb;res = fn.apply(self, args);}if (res &&(typeof res === "object" || typeof res === "function") &&typeof res.then === "function") {rs(res);}});};';return Function(["Promise","fn"],o)(i,t)}var i=n(17),u=n(23);t.exports=i,i.denodeify=function(t,e){return"number"==typeof e&&e!==1/0?r(t,e):o(t)};var a="function (err, res) {if (err) { rj(err); } else { rs(res); }}";i.nodeify=function(t){return function(){var e=Array.prototype.slice.call(arguments),n="function"==typeof e[e.length-1]?e.pop():null,r=this;try{return t.apply(this,arguments).nodeify(n,r)}catch(t){if(null===n||void 0===n)return new i(function(e,n){n(t)});u(function(){n.call(r,t)})}}},i.prototype.nodeify=function(t,e){return"function"!=typeof t?this:void this.then(function(n){u(function(){t.call(e,null,n)})},function(n){u(function(){t.call(e,n)})})}},function(t,e,n){"use strict";function r(t){var e;e=u.length?u.pop():new o,e.task=t,e.domain=process.domain,i(e)}function o(){this.task=null,this.domain=null}var i=n(18),u=[];t.exports=r,o.prototype.call=function(){this.domain&&this.domain.enter();var t=!0;try{this.task.call(),t=!1,this.domain&&this.domain.exit()}finally{t&&i.requestFlush(),this.task=null,this.domain=null,u.push(this)}}},function(t,e,n){"use strict";var r=n(17);t.exports=r,r.enableSynchronous=function(){r.prototype.isPending=function(){return 0==this.getState()},r.prototype.isFulfilled=function(){return 1==this.getState()},r.prototype.isRejected=function(){return 2==this.getState()},r.prototype.getValue=function(){if(3===this._83)return this._18.getValue();if(!this.isFulfilled())throw Error("Cannot get a value of an unfulfilled promise.");return this._18},r.prototype.getReason=function(){if(3===this._83)return this._18.getReason();if(!this.isRejected())throw Error("Cannot get a rejection reason of a non-rejected promise.");return this._18},r.prototype.getState=function(){return 3===this._83?this._18.getState():this._83===-1||this._83===-2?0:this._83}},r.disableSynchronous=function(){r.prototype.isPending=void 0,r.prototype.isFulfilled=void 0,r.prototype.isRejected=void 0,r.prototype.getValue=void 0,r.prototype.getReason=void 0,r.prototype.getState=void 0}},function(t,e){"use strict";function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=-1,u=1;e.expandCathegories=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n({},i,{id:i,value:"Все"}),r=t.cathegories;return Array.isArray(r)||(r=[]),r=r.map(function(t,n){var r=u<<n;return e[r]={id:r,value:t},r}),r.unshift(i),o({},t,{cathegories:r,cathegoryList:e})},e.compressCathegories=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var e=t.cathegoryList;if(!e||"object"!==(void 0===e?"undefined":r(e)))return t;var n=o({},t);delete n.cathegoryList;var u=n.cathegories;return Array.isArray(u)?(u=u.filter(function(t){return t!==i}).map(function(t){return e[t].value}),o({},n,{cathegories:u})):n}catch(e){return t}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),o=n(27);e.default=function(t,e){(0,r.getPostData)(t).then(function(t){var e=t.path,n=t.service,r=t.command,i=t.params||{};switch(n){case"data":return t(e,r,i);case"cathegories":return(0,o.cathegories)(e,r,i);case"goods":return(0,o.goods)(e,r,i);case"getDefaults":return(0,o.getDefaults)(e,r,i);case"fields":return(0,o.fields)(e,r,i);default:throw"Unknown service"}}).then(function(t){return(0,r.sendData)(e,!!t,t)},function(t){return(0,r.sendError)(e,500,t.message||t)})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.fields=e.getDefaults=e.goods=e.cathegories=e.data=void 0;var o=n(28),i=r(o),u=n(31),a=r(u),s=n(32),c=r(s),f=n(33),l=r(f),d=n(34),p=r(d);e.data=i.default,e.cathegories=a.default,e.goods=c.default,e.getDefaults=l.default,e.fields=p.default},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.setCommand=e.getCommand=void 0;var o=n(7),i=n(15),u=r(i),a=n(29),s=n(10),c=e.getCommand="read",f=e.setCommand="write";e.default=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new u.default(function(r,i){switch(e){case c:(0,o.getFileInfo)(t).then(function(t){var e=t.exists,n=t.fileType,r=t.absolute;return e?("regular file"!==n&&i("Path is unapproachable."),(0,o.readFile)(r,a.ENCODING)):"{}"}).then(function(t){try{r((0,s.expandCathegories)(JSON.parse(t)))}catch(t){i("Reading data error.")}},function(t){return i("Reading data error.")});break;case f:try{n=(0,s.compressCathegories)(JSON.stringify(n)),(0,o.writeFile)(t,n,a.ENCODING).then(function(t){return r("OK")},function(t){return i("Can not save data "+JSON.stringify(n)+".")})}catch(t){i(t)}break;default:i('Unknown command "'+e+'" for data service.')}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ENCODING=void 0;var r=n(30);e.ENCODING=r.ENCODING},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ENCODING="utf8"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(28),i=r(o),u="getCathegories";e.default=function(t,e){arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,i.default)(t,o.getCommand,{}).then(function(t){switch(e){case u:var n=t.cathegories,r=t.cathegoryList;return{cathegories:n,cathegoryList:r};default:throw'Unknown command "'+e+'"'}})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,
t}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=n(28),c=r(s),f="getGoods",l="getGood",d="byGoods",p="saveGood";e.default=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,c.default)(t,s.getCommand,{}).then(function(r){var c=a({},n),h=a({},r),v=h.goods||{};switch(e){case f:var y=h.requiredFields||[],g=c.cathegory,_=Object.keys(v).filter(function(t){return v.id&&v.id.cathegories&g}),m=_.reduce(function(t,e){var n=v[e];return t[e]=y.reduce(function(t,e){var r;return a({},t,(r={},o(r,e,n[e]),o(r,"complite",!1),r))},{}),t},{});return{hash:m,ids:_};case l:var b=c.id,w=v[b];return a({},w,{complite:!0});case d:var j=c.goodList;if(!Array.isArray(j))throw"Incorrect good list";return j.forEach(function(t){var e=t.id,n=t.amount,r=void 0===n?0:n,o=v[e];if("object"!==(void 0===o?"undefined":u(o)))throw"Incorrect data format for good #"+e;var i=o.amount,s=void 0===i?0:i,c=s-r;if(isNaN(c)||c<0)throw"Incorrect operation.";v[e]=a({},o,{id:e,amount:c})}),r(t,s.setCommand,a({},h,{goods:v}));case p:var x=c.good;if("object"!==(void 0===x?"undefined":u(x)))throw"Incorrect data.";var O=x,P=O.id;if(!P){var M=Object.keys(v).map(function(t){return v[t].id}).sort(function(t,e){return t-e}),C=i(M,1),S=C[0];P=S>0?M[S-1]+1:1,x=a({},x,{id:P})}return r(t,s.setCommand,a({},h,{goods:a({},v,o({},P,x))}));default:throw'Unknown command "'+e+'"'}})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=n(28),u=r(i);e.default=function(t,e){arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,u.default)(t,i.getCommand,{}).then(function(t){var e=t.defaults;return"object"===(void 0===e?"undefined":o(e))?e:{}})}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(28),i=r(o),u="getFields";e.default=function(t,e){arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,i.default)(t,o.getCommand,{}).then(function(t){switch(e){case u:var n=t.fields;return{fields:n};default:throw'Unknown command "'+e+'"'}})}}])});